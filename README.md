
# DataFromVk

–°–µ—Ä–≤–∏—Å –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –§–ò–û –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —Å —Å–∞–π—Ç–∞ [VK](https://vk.com/), –∞ —Ç–∞–∫–∂–µ –ø—Ä–∏–∑–Ω–∞–∫–∞ —É—á–∞—Å—Ç–Ω–∏–∫–∞ –≥—Ä—É–ø–ø—ã.


# –°–µ—Ä–≤–∏—Å–Ω—ã–π –∫–ª—é—á –¥–æ—Å—Ç—É–ø–∞

–î–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –≤–∞–º –Ω—É–∂–µ–Ω VK_TOKEN. –ß—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å —Ç–æ–∫–µ–Ω, –Ω–∞–¥–æ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è –Ω–∞ https://dev.vk.com/.

–î–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —Ç–µ—Å—Ç–æ–≤ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ —Å–æ–∑–¥–∞—Ç—å —Ñ–∞–π–ª .env —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–º `vk-access-token` –∏ –∑–Ω–∞—á–µ–Ω–∏–µ–º VK_TOKEN.

# –ó–∞–ø—É—Å–∫ –≤ minikube

–ó–∞–ø—É—Å—Ç–∏—Ç–µ –∫–ª–∞—Å—Ç–µ—Ä minikube:

```console
$ minikube start
```

–†–∞–∑–≤–µ—Ä–Ω–∏—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ:

```console
$ kubectl apply -f kuber.yml
```

–ü—Ä–æ–∫–∏–Ω—å—Ç–µ —Å–µ—Ç–µ–≤–æ–π –¥–æ—Å—Ç—É–ø –∫ —Å–µ—Ä–≤–∏—Å—É –≤–Ω—É—Ç—Ä–∏ –∫–ª–∞—Å—Ç–µ—Ä–∞:

```console
$ minikube service -n tatanka27 datafromvk
|-----------|------------|-------------|---------------------------|
| NAMESPACE |    NAME    | TARGET PORT |            URL            |
|-----------|------------|-------------|---------------------------|
| tatanka27 | datafromvk |        8080 | http://192.168.49.2:30007 |
|-----------|------------|-------------|---------------------------|
üèÉ  Starting tunnel for service datafromvk.
|-----------|------------|-------------|------------------------|
| NAMESPACE |    NAME    | TARGET PORT |          URL           |
|-----------|------------|-------------|------------------------|
| tatanka27 | datafromvk |             | http://127.0.0.1:53841 |
|-----------|------------|-------------|------------------------|
üéâ  Opening service tatanka27/datafromvk in default browser...
‚ùó  Because you are using a Docker driver on windows, the terminal needs to be open to run it.
```
(–¥–ª—è windows —Ç–µ—Ä–º–∏–Ω–∞–ª –æ—Å—Ç–∞–≤–ª—è—Ç—å –æ—Ç–∫—Ä—ã—Ç—ã–º)

–í—ã–ø–æ–ª–Ω–∏—Ç–µ –∑–∞–ø—Ä–æ—Å—ã –∫ —Å–µ—Ä–≤–∏—Å—É, –∏—Å–ø–æ–ª—å–∑—É—è –ø–æ—Ä—Ç, —É–∫–∞–∑–∞–Ω–Ω—ã–π –≤ –≤—ã–≤–æ–¥–µ (–≤ –ø—Ä–∏–º–µ—Ä–µ –≤—ã—à–µ `53841`).

# REST API

–û–ø—Å–∏–∞–Ω–∏–µ API —Å–º–æ—Ç—Ä–∏ –≤ [openapi.yaml](openapi.yaml).

# –ü—Ä–∏–º–µ—Ä—ã –∑–∞–ø—Ä–æ—Å–∞

##  –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–∏ OpenAPI —Å–µ—Ä–≤–∏—Å–∞

–ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–æ –Ω–∞–¥–æ –∞–≤—Ç–æ—Ä–∏–∑–∏—Ä–æ–≤–∞—Ç—å—Å—è –≤ —Å–µ—Ä–≤–∏—Å–µ —Å –¥–∞–Ω–Ω—ã–º–∏ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞ (—Å–º–æ—Ç—Ä–∏ –∑–∞–ø—Ä–æ—Å "–ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è").

### –ó–∞–ø—Ä–æ—Å

`GET /api/v3/api-docs`

```console
curl http://localhost:8080/api/v3/api-docs -H "Authorization: Bearer JWT_TOKEN"
```

### –û—Ç–≤–µ—Ç

–í –æ—Ç–≤–µ—Ç–µ –ø—Ä–∏—Ö–æ–¥–∏—Ç json, –∫–æ—Ç–æ—Ä—ã–π –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –Ω–∞ —Å–∞–π—Ç–µ [swagger](https://editor.swagger.io/).


## –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

### –ó–∞–ø—Ä–æ—Å

`POST /user/registration`

```console
curl http://localhost:8080/user/registration -H "Content-Type: application/json" --data @data.json -v    
```

–ü—Ä–∏–º–µ—Ä `data.json`:

```json
{
    "username": "test@test.ru",
    "password": "123456"
}
```

### –û—Ç–≤–µ—Ç

```text
{
    HTTP/1.1 200
}
```


## –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è

### –ó–∞–ø—Ä–æ—Å

`POST /login`

```console
curl http://localhost:8080/login -H "Content-Type: application/json" --data @data.json -v    
```

–ü—Ä–∏–º–µ—Ä `data.json`:

```json
{
    "username": "admin@admin.ru",
    "password": "123456"
}
```

### –û—Ç–≤–µ—Ç

```json
{
  "token":"eyJhbGci...7I57_rEB0Al8RP3ChQRzk_JFze8z_48vW0DJQcKPgm_3qSQ"
}
```

–≠—Ç–æ—Ç —Ç–æ–∫–µ–Ω –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–∞–ª—å—à–µ –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ –∑–∞–ø—Ä–æ—Å–æ–≤ - JWT_TOKEN.

## –ü–æ–ª—É—á–µ–Ω–∏—è –§–ò–û –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —Å —Å–∞–π—Ç–∞ vk.com, –∞ —Ç–∞–∫–∂–µ –ø—Ä–∏–∑–Ω–∞–∫–∞ —É—á–∞—Å—Ç–Ω–∏–∫–∞ –≥—Ä—É–ø–ø—ã VK

### –ó–∞–ø—Ä–æ—Å

`GET /user_vk`

```console
curl http://localhost:8080/user_vk -X GET -H "Authorization: Bearer JWT_TOKEN" -H "Content-Type: application/json" -H "vk_service_token: VK_TOKEN" --data @data.json -v    
```

–ü—Ä–∏–º–µ—Ä `data.json`:

```json
{
    "user_id": "1",
    "group_id": "1"
}
```

### –û—Ç–≤–µ—Ç

```json
{
    "last_name":"Durov",
    "first_name":"Pavel",
    "middle_name":null,
    "member":false
}
```


# –£–¥–∞–ª–µ–Ω–∏–µ –∫–ª–∞—Å—Ç–µ—Ä–∞

–í –æ—Ç–∫—Ä—ã—Ç–æ–º –æ–∫–Ω–µ —Ç–µ—Ä–º–∏–Ω–∞–ª–∞ –Ω–∞–∂–º–∏—Ç–µ CTRL+C, —á—Ç–æ–±—ã –æ—Å—Ç–∞–≤–Ω–æ–∏—Ç—å –ø—Ä–æ–±—Ä–æ—Å –ø–æ—Ä—Ç–æ–≤.

–ß—Ç–æ–±—ã —É–¥–∞–ª–∏—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∏–∑ –∫–ª–∞—Å—Ç–µ—Ä–∞:

```console
$ kubectl delete -f kuber.yml
```

–ß—Ç–æ–±—ã —É–¥–∞–ª–∏—Ç—å –∫–ª–∞—Å—Ç–µ—Ä:

```console
$ minikube delete
```